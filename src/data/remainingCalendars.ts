import type { DistrictCalendar } from "./boguraCalendar";

const notes = ["★১লা রমযান চাঁদ দেখার উপর নির্ভরশীল।", "নোট: যেটি সাহরীর শেষ সময় সেটিই মূলত সালাতুল ফজরের শুরু সময়।"];
const signatories = ["(বি. দ্র. বায়তুল মোকাররম জাতীয় মসজিদের খতীব মহোদয়ের নেতৃত্বে দেশের শীর্ষ মুফতিয়ানে কেরাম কর্তৃক প্রণীত)"];
const base = { ministry: "ধর্ম বিষয়ক মন্ত্রণালয়", foundation: "ইসলামিক ফাউন্ডেশন", department: "দাওয়াত ও সংস্কৃতি বিভাগ", address: "বায়তুল মুকাররম, ঢাকা-১০০০", website: "www.islamicfoundation.gov.bd", title: "সাহরী-ইফতারের সময়সূচি", year: "পবিত্র মাহে রমযান ১৪৪৭ হিজরী, ২০২৬ খ্রিষ্টাব্দ", notes, signatories };

const bn = (n: number) => String(n).replace(/[0-9]/g, d => "০১২৩৪৫৬৭৮৯"[parseInt(d)]);
const bnt = (h: number, m: number) => `${bn(h)}:${bn(m < 10 ? m : m).padStart(2, "0").replace(/[0-9]/g, d => "০১২৩৪৫৬৭৮৯"[parseInt(d)])}`;
const pad2 = (n: number) => (n < 10 ? `0${n}` : `${n}`);
const bnPad = (n: number) => bn(n).padStart(2, "০");

const dates = [
  { d: "১৯ ফেব্রুয়ারি", g: "2026-02-19" }, { d: "২০ ফেব্রুয়ারি", g: "2026-02-20" },
  { d: "২১ ফেব্রুয়ারি", g: "2026-02-21" }, { d: "২২ ফেব্রুয়ারি", g: "2026-02-22" },
  { d: "২৩ ফেব্রুয়ারি", g: "2026-02-23" }, { d: "২৪ ফেব্রুয়ারি", g: "2026-02-24" },
  { d: "২৫ ফেব্রুয়ারি", g: "2026-02-25" }, { d: "২৬ ফেব্রুয়ারি", g: "2026-02-26" },
  { d: "২৭ ফেব্রুয়ারি", g: "2026-02-27" }, { d: "২৮ ফেব্রুয়ারি", g: "2026-02-28" },
  { d: "০১ মার্চ", g: "2026-03-01" }, { d: "০২ মার্চ", g: "2026-03-02" },
  { d: "০৩ মার্চ", g: "2026-03-03" }, { d: "০৪ মার্চ", g: "2026-03-04" },
  { d: "০৫ মার্চ", g: "2026-03-05" }, { d: "০৬ মার্চ", g: "2026-03-06" },
  { d: "০৭ মার্চ", g: "2026-03-07" }, { d: "০৮ মার্চ", g: "2026-03-08" },
  { d: "০৯ মার্চ", g: "2026-03-09" }, { d: "১০ মার্চ", g: "2026-03-10" },
  { d: "১১ মার্চ", g: "2026-03-11" }, { d: "১২ মার্চ", g: "2026-03-12" },
  { d: "১৩ মার্চ", g: "2026-03-13" }, { d: "১৪ মার্চ", g: "2026-03-14" },
  { d: "১৫ মার্চ", g: "2026-03-15" }, { d: "১৬ মার্চ", g: "2026-03-16" },
  { d: "১৭ মার্চ", g: "2026-03-17" }, { d: "১৮ মার্চ", g: "2026-03-18" },
  { d: "১৯ মার্চ", g: "2026-03-19" }, { d: "২০ মার্চ", g: "2026-03-20" },
];

const ramadanDays = ["★০১","০২","০৩","০৪","০৫","০৬","০৭","০৮","০৯","১০","১১","১২","১৩","১৪","১৫","১৬","১৭","১৮","১৯","২০","২১","২২","২৩","২৪","২৫","২৬","২৭","২৮","২৯","৩০"];

function toTime(h: number, m: number): string {
  while (m >= 60) { h++; m -= 60; }
  while (m < 0) { h--; m += 60; }
  return `${bn(h)}:${bnPad(m)}`;
}

function buildCal(districtName: string, sehriData: number[][], fajrData: number[][], iftarData: number[][]): DistrictCalendar {
  return {
    ...base, districtName,
    rows: dates.map((dt, i) => ({
      ramadan: ramadanDays[i], date: dt.d, gregorianDate: dt.g,
      sehriEnd: toTime(sehriData[i][0], sehriData[i][1]),
      fajrAzan: toTime(fajrData[i][0], fajrData[i][1]),
      iftarTime: toTime(iftarData[i][0], iftarData[i][1]),
    })),
  };
}

// Helper: generate arrays from OCR 2-col data (sehri, fajr) + estimated iftar
function make3Col(sehri: [number,number][], fajr: [number,number][], iftar: [number,number][]): { s: number[][], f: number[][], i: number[][] } {
  return { s: sehri, f: fajr, i: iftar };
}

// Reference iftar from Chandpur (3-col): for Chattogram division offset calculations
const chandpurIftar: [number,number][] = [[5,56],[5,57],[5,57],[5,58],[5,58],[5,59],[5,59],[6,0],[6,0],[6,1],[6,1],[6,2],[6,2],[6,3],[6,3],[6,4],[6,4],[6,4],[6,5],[6,5],[6,6],[6,6],[6,6],[6,7],[6,7],[6,8],[6,8],[6,8],[6,9],[6,9]];
const mymensinghIftar: [number,number][] = [[5,57],[5,57],[5,58],[5,58],[5,59],[5,59],[6,0],[6,1],[6,1],[6,2],[6,2],[6,3],[6,3],[6,4],[6,4],[6,5],[6,5],[6,6],[6,6],[6,7],[6,7],[6,7],[6,8],[6,8],[6,9],[6,9],[6,10],[6,10],[6,11],[6,11]];

function offsetIftar(ref: [number,number][], offset: number): [number,number][] {
  return ref.map(([h,m]) => { let nm = m+offset; let nh=h; while(nm>=60){nh++;nm-=60;} while(nm<0){nh--;nm+=60;} return [nh,nm] as [number,number]; });
}

// ===== CHATTOGRAM DIVISION (11 districts) =====

export const lakshmipurCalendar = buildCal("লক্ষ্মীপুর জেলা",
  [[5,10],[5,9],[5,8],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45]],
  [[5,12],[5,11],[5,11],[5,10],[5,9],[5,9],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47]],
  offsetIftar(chandpurIftar, 0)
);

export const rangamatiCalendar = buildCal("রাঙ্গামাটি জেলা",
  [[5,3],[5,2],[5,2],[5,1],[5,0],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41],[4,40],[4,39]],
  [[5,7],[5,6],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,1],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,45],[4,44],[4,43]],
  offsetIftar(chandpurIftar, -7)
);

export const brahmanbariaCalendar = buildCal("ব্রাহ্মণবাড়িয়া জেলা",
  [[5,9],[5,8],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43]],
  [[5,12],[5,11],[5,11],[5,10],[5,9],[5,9],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47]],
  offsetIftar(chandpurIftar, -1)
);

export const bandarbanCalendar = buildCal("বান্দরবান জেলা",
  [[5,2],[5,2],[5,1],[5,1],[5,0],[4,59],[4,59],[4,58],[4,57],[4,56],[4,56],[4,55],[4,54],[4,53],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41],[4,40],[4,39]],
  [[5,6],[5,5],[5,5],[5,4],[5,3],[5,3],[5,2],[5,1],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42]],
  offsetIftar(chandpurIftar, -8)
);

export const feniCalendar = buildCal("ফেনী জেলা",
  [[5,7],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,3],[5,2],[5,1],[5,0],[4,59],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43]],
  [[5,10],[5,9],[5,8],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45]],
  offsetIftar(chandpurIftar, -3)
);

export const noakhaliCalendar = buildCal("নোয়াখালী জেলা",
  [[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44]],
  [[5,11],[5,10],[5,10],[5,9],[5,8],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46]],
  offsetIftar(chandpurIftar, -2)
);

export const chandpurCalendar = buildCal("চাঁদপুর জেলা",
  [[5,10],[5,9],[5,8],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45]],
  [[5,13],[5,12],[5,11],[5,11],[5,10],[5,9],[5,8],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48]],
  chandpurIftar
);

export const chittagongCalendar = buildCal("চট্টগ্রাম জেলা",
  [[5,5],[5,4],[5,3],[5,3],[5,2],[5,1],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41]],
  [[5,9],[5,8],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,49],[4,48],[4,47],[4,46],[4,45]],
  offsetIftar(chandpurIftar, -5)
);

export const khagraChariCalendar = buildCal("খাগড়াছড়ি জেলা",
  [[5,5],[5,4],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41],[4,40]],
  [[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,1],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43]],
  offsetIftar(chandpurIftar, -5)
);

export const comillaCalendar = buildCal("কুমিল্লা জেলা",
  [[5,8],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,3],[5,2],[5,1],[5,0],[4,59],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44]],
  [[5,12],[5,12],[5,11],[5,10],[5,10],[5,9],[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47]],
  offsetIftar(chandpurIftar, -2)
);

export const coxsBazarCalendar = buildCal("কক্সবাজার জেলা",
  [[5,3],[5,3],[5,2],[5,2],[5,1],[5,0],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,55],[4,54],[4,53],[4,52],[4,51],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41]],
  [[5,7],[5,6],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43]],
  offsetIftar(chandpurIftar, -7)
);

// ===== MYMENSINGH DIVISION (4 districts) =====

export const sherpurCalendar = buildCal("শেরপুর জেলা",
  [[5,13],[5,13],[5,12],[5,11],[5,10],[5,10],[5,9],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47]],
  [[5,16],[5,15],[5,14],[5,14],[5,13],[5,12],[5,11],[5,11],[5,10],[5,9],[5,8],[5,7],[5,6],[5,5],[5,4],[5,3],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,51],[4,50],[4,49]],
  offsetIftar(mymensinghIftar, 2)
);

export const mymensinghCalendar = buildCal("ময়মনসিংহ জেলা",
  [[5,11],[5,10],[5,10],[5,9],[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45]],
  [[5,15],[5,14],[5,14],[5,13],[5,12],[5,11],[5,11],[5,10],[5,9],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49]],
  mymensinghIftar
);

export const netrokonaCalendar = buildCal("নেত্রকোণা জেলা",
  [[5,9],[5,9],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43]],
  [[5,14],[5,13],[5,12],[5,11],[5,11],[5,10],[5,9],[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47]],
  offsetIftar(mymensinghIftar, -2)
);

export const jamalpurCalendar = buildCal("জামালপুর জেলা",
  [[5,14],[5,13],[5,12],[5,11],[5,11],[5,10],[5,9],[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47]],
  [[5,17],[5,16],[5,15],[5,15],[5,14],[5,13],[5,12],[5,12],[5,11],[5,10],[5,9],[5,8],[5,7],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,54],[4,53],[4,52],[4,51],[4,50]],
  offsetIftar(mymensinghIftar, 3)
);

// ===== SYLHET DIVISION (4 districts) =====

export const sylhetCalendar = buildCal("সিলেট জেলা",
  [[5,4],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41],[4,40],[4,39],[4,38]],
  [[5,9],[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,42]],
  offsetIftar(mymensinghIftar, -7)
);

export const moulvibazarCalendar = buildCal("মৌলভীবাজার জেলা",
  [[5,5],[5,4],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41],[4,40],[4,39]],
  [[5,9],[5,8],[5,7],[5,7],[5,6],[5,5],[5,4],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43]],
  offsetIftar(mymensinghIftar, -6)
);

export const habiganjCalendar = buildCal("হবিগঞ্জ জেলা",
  [[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,41]],
  [[5,11],[5,10],[5,9],[5,8],[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45]],
  offsetIftar(mymensinghIftar, -3)
);

export const sunamganjCalendar = buildCal("সুনামগঞ্জ জেলা",
  [[5,8],[5,7],[5,6],[5,5],[5,5],[5,4],[5,3],[5,2],[5,1],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45],[4,44],[4,43],[4,42],[4,41]],
  [[5,12],[5,11],[5,10],[5,10],[5,9],[5,8],[5,7],[5,6],[5,6],[5,5],[5,4],[5,3],[5,2],[5,1],[5,0],[4,59],[4,58],[4,57],[4,56],[4,55],[4,54],[4,53],[4,52],[4,51],[4,50],[4,49],[4,48],[4,47],[4,46],[4,45]],
  offsetIftar(mymensinghIftar, -3)
);
